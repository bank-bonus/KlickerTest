<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Case Simulator Images</title>
    <style>
        :root {
            --bg-color: #1b1b1b;
            --card-bg: #2b2b2b;
            --accent: #e8c64d;
            --green: #4bb34b;
            --red: #e64646;
        }
        body {
            background-color: var(--bg-color);
            color: white;
            font-family: -apple-system, system-ui, Roboto, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        /* --- –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ --- */
        .item-image {
            width: 60px;
            height: 60px;
            object-fit: contain; /* –ß—Ç–æ–±—ã –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ —Ä–∞—Å—Ç—è–≥–∏–≤–∞–ª–∞—Å—å */
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5)); /* –¢–µ–Ω—å –ø–æ–¥ –ø—Ä–µ–¥–º–µ—Ç–æ–º */
        }
        
        /* –ë–æ–ª—å—à–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –æ–∫–Ω–µ –≤—ã–∏–≥—Ä—ã—à–∞ */
        .win-img-big {
            width: 120px;
            height: 120px;
            object-fit: contain;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 15px rgba(255,255,255,0.2));
        }

        /* –ò–∫–æ–Ω–∫–∞ –∫–µ–π—Å–∞ –≤ –º–µ–Ω—é */
        .case-img-icon {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 10px;
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .header { padding: 15px; background: #222; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.5); z-index: 20; }
        .balance-box { font-size: 18px; font-weight: bold; color: var(--green); }
        .inv-btn { background: #333; border: 1px solid #555; color: white; padding: 8px 15px; border-radius: 8px; font-size: 14px; cursor: pointer; }

        .screen { flex: 1; display: none; flex-direction: column; overflow-y: auto; padding-bottom: 20px; }
        .active-screen { display: flex; }

        .case-list { padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .case-card { background: var(--card-bg); border-radius: 12px; padding: 15px; text-align: center; cursor: pointer; border: 2px solid transparent; transition: transform 0.1s; }
        .case-card:active { transform: scale(0.95); }
        .case-name { font-weight: bold; margin-bottom: 5px; font-size: 14px; }
        .case-price { color: var(--accent); font-weight: bold; font-size: 14px; }

        .game-area { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; }
        .back-btn { position: absolute; top: 70px; left: 20px; background: none; border: none; color: #888; font-size: 16px; cursor: pointer; }
        .roulette-container { position: relative; width: 100%; height: 140px; background: #111; border-top: 2px solid #444; border-bottom: 2px solid #444; overflow: hidden; margin: 20px 0; }
        .center-line { position: absolute; left: 50%; top: 0; bottom: 0; width: 4px; background: var(--accent); transform: translateX(-50%); z-index: 5; box-shadow: 0 0 10px var(--accent); }
        .strip { display: flex; height: 100%; align-items: center; }
        
        .item { min-width: 100px; height: 100px; margin: 0 5px; background: #252525; border-radius: 8px; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 30px; border-bottom: 4px solid #555; position: relative; }
        .item span { font-size: 10px; margin-top: 5px; color: #ccc; }
        
        .r-1 { border-color: #b0c3d9; } 
        .r-2 { border-color: #5e98d9; } 
        .r-3 { border-color: #8847ff; } 
        .r-4 { border-color: #d32ce6; } 
        .r-5 { border-color: #eb4b4b; } 
        .r-6 { border-color: #ffd700; box-shadow: 0 0 10px #ffd700; } 

        .spin-btn { background: linear-gradient(90deg, #fdc830 0%, #f37335 100%); border: none; padding: 15px 60px; color: white; font-size: 20px; font-weight: bold; border-radius: 30px; box-shadow: 0 5px 20px rgba(243, 115, 53, 0.4); }
        .spin-btn:disabled { filter: grayscale(1); opacity: 0.5; }

        .inventory-grid { padding: 20px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .inv-item { background: #252525; padding: 10px; border-radius: 8px; text-align: center; position: relative; }
        .inv-sell-one { margin-top: 5px; background: #333; color: var(--green); border: none; width: 100%; padding: 4px; border-radius: 4px; font-size: 12px; }
        .empty-msg { text-align: center; color: #666; margin-top: 50px; width: 100%; }

        #win-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 100; flex-direction: column; justify-content: center; align-items: center; animation: fadeIn 0.3s; }
        .win-card { background: #222; padding: 25px; border-radius: 20px; text-align: center; width: 280px; border: 2px solid #444; }
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        .btn-action { flex: 1; padding: 12px; border: none; border-radius: 8px; color: white; font-weight: bold; font-size: 14px; }
        .btn-sell { background: var(--green); }
        .btn-keep { background: #5181b8; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div class="header">
        <div class="balance-box" id="balance">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <button class="inv-btn" onclick="showInventory()">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
    </div>

    <!-- –ú–ï–ù–Æ -->
    <div id="screen-menu" class="screen active-screen">
        <div style="padding: 20px; text-align: center; color: #888;">–ú–∞–≥–∞–∑–∏–Ω –∫–µ–π—Å–æ–≤</div>
        <div class="case-list" id="cases-container"></div>
    </div>

    <!-- –ò–ì–†–ê -->
    <div id="screen-game" class="screen">
        <button class="back-btn" onclick="showMenu()">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="game-area">
            <h2 id="current-case-name">–ù–∞–∑–≤–∞–Ω–∏–µ</h2>
            <div id="current-case-price" style="color: #888; margin-bottom: 20px;">0 $</div>
            <div class="roulette-container">
                <div class="center-line"></div>
                <div class="strip" id="strip"></div>
            </div>
            <button class="spin-btn" id="spin-btn" onclick="spin()">–û–¢–ö–†–´–¢–¨</button>
        </div>
    </div>

    <!-- –ò–ù–í–ï–ù–¢–ê–†–¨ -->
    <div id="screen-inventory" class="screen">
        <button class="back-btn" style="position:static; margin: 15px;" onclick="showMenu()">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="inventory-grid" id="inventory-grid"></div>
        <button onclick="sellAll()" style="margin: 20px; padding: 15px; background: var(--red); color: white; border:none; border-radius: 10px;">–ü–†–û–î–ê–¢–¨ –í–°–Å</button>
    </div>

    <!-- –û–ö–ù–û –í–´–ò–ì–†–´–®–ê -->
    <div id="win-modal">
        <div class="win-card" id="win-card-ui">
            <!-- –°—é–¥–∞ –≤—Å—Ç–∞–≤–∏—Ç—Å—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ -->
            <img src="" id="win-img-src" class="win-img-big">
            <h3 id="win-name">–ü—Ä–µ–¥–º–µ—Ç</h3>
            <p style="color: #aaa;" id="win-price-text">–°—Ç–æ–∏–º–æ—Å—Ç—å: 0 $</p>
            <div class="btn-group">
                <button class="btn-action btn-sell" onclick="actionSell()">üí∞ –ü—Ä–æ–¥–∞—Ç—å<br><span id="sell-price-btn">+0$</span></button>
                <button class="btn-action btn-keep" onclick="actionKeep()">üéí –û—Å—Ç–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
    <script>
        vkBridge.send('VKWebAppInit');
        
        let balance = 5000;
        let inventory = [];
        let currentCaseId = null;
        let currentWonItem = null;

        // --- –í–ê–ñ–ù–û: –°–°–´–õ–ö–ò –ù–ê –ö–ê–†–¢–ò–ù–ö–ò ---
        // –ï—Å–ª–∏ —Ç—ã –∑–∞–≥—Ä—É–∑–∏–ª –∫–∞—Ä—Ç–∏–Ω–∫–∏ –Ω–∞ GitHub –≤ —Ç—É –∂–µ –ø–∞–ø–∫—É, –ø–∏—à–∏ –ø—Ä–æ—Å—Ç–æ –∏–º—è —Ñ–∞–π–ª–∞: 'iphone.png'
        // –Ø –ø–æ–∫–∞ –ø–æ—Å—Ç–∞–≤–∏–ª —Å—Å—ã–ª–∫–∏ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞.
        
        const itemsDB = {
            garbage: [
                { name: "–°—Ç–∏–∫–µ—Ä", img: "https://cdn-icons-png.flaticon.com/512/4525/4525026.png", price: 10, rarity: 1 },
                { name: "–ù–æ—Å–æ–∫", img: "https://cdn-icons-png.flaticon.com/512/2310/2310237.png", price: 50, rarity: 1 },
            ],
            low: [
                { name: "–ù–∞—É—à–Ω–∏–∫–∏", img: "https://cdn-icons-png.flaticon.com/512/5906/5906124.png", price: 200, rarity: 2 },
                { name: "–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞", img: "https://cdn-icons-png.flaticon.com/512/9839/9839446.png", price: 400, rarity: 2 },
            ],
            mid: [
                { name: "iPhone 13", img: "https://cdn-icons-png.flaticon.com/512/644/644458.png", price: 1200, rarity: 3 },
                { name: "PlayStation 5", img: "https://cdn-icons-png.flaticon.com/512/5906/5906062.png", price: 800, rarity: 3 },
            ],
            high: [
                { name: "MacBook", img: "https://cdn-icons-png.flaticon.com/512/2000/2000282.png", price: 3000, rarity: 4 },
                { name: "–ò–≥—Ä–æ–≤–æ–π –ü–ö", img: "https://cdn-icons-png.flaticon.com/512/1792/1792525.png", price: 5000, rarity: 4 },
            ],
            super: [
                { name: "Tesla Model S", img: "https://cdn-icons-png.flaticon.com/512/3202/3202926.png", price: 50000, rarity: 5 },
                { name: "–í–∏–ª–ª–∞", img: "https://cdn-icons-png.flaticon.com/512/2412/2412695.png", price: 150000, rarity: 5 },
            ],
            god: [
                { name: "–Ø—Ö—Ç–∞", img: "https://cdn-icons-png.flaticon.com/512/2942/2942080.png", price: 500000, rarity: 6 },
                { name: "–°–∞–º–æ–ª–µ—Ç", img: "https://cdn-icons-png.flaticon.com/512/2204/2204344.png", price: 2000000, rarity: 6 },
            ]
        };

        const cases = [
            { id: 0, name: "–ë–æ–º–∂ –ë–æ–∫—Å", price: 100, img: "https://cdn-icons-png.flaticon.com/512/679/679720.png", pool: [...itemsDB.garbage, ...itemsDB.low], weights: [70, 30] },
            { id: 1, name: "–ú–∞–∂–æ—Ä –ë–æ–∫—Å", price: 1000, img: "https://cdn-icons-png.flaticon.com/512/2983/2983870.png", pool: [...itemsDB.low, ...itemsDB.mid, ...itemsDB.high], weights: [50, 40, 10] },
            { id: 2, name: "–û–ª–∏–≥–∞—Ä—Ö –ë–æ–∫—Å", price: 10000, img: "https://cdn-icons-png.flaticon.com/512/2721/2721115.png", pool: [...itemsDB.mid, ...itemsDB.high, ...itemsDB.super, ...itemsDB.god], weights: [50, 30, 15, 5] }
        ];

        // --- –õ–û–ì–ò–ö–ê –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø (–¢–µ–ø–µ—Ä—å —Å <img>) ---

        function updateBalance() { document.getElementById('balance').innerText = balance + " $"; }

        function renderCases() {
            const container = document.getElementById('cases-container');
            container.innerHTML = '';
            cases.forEach(c => {
                const div = document.createElement('div');
                div.className = 'case-card';
                div.onclick = () => openGame(c.id);
                // –¢—É—Ç –º—ã –≤—Å—Ç–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–µ–π—Å–∞
                div.innerHTML = `
                    <img src="${c.img}" class="case-img-icon">
                    <div class="case-name">${c.name}</div>
                    <div class="case-price">${c.price} $</div>
                `;
                container.appendChild(div);
            });
        }

        function createCard(item) {
            const div = document.createElement('div');
            div.className = `item r-${item.rarity}`;
            // –¢—É—Ç –º—ã –≤—Å—Ç–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –ø—Ä–µ–¥–º–µ—Ç–∞
            div.innerHTML = `<img src="${item.img}" class="item-image"><span>${item.price}$</span>`;
            return div;
        }

        function renderInventory() {
            const grid = document.getElementById('inventory-grid');
            grid.innerHTML = '';
            if (inventory.length === 0) { grid.innerHTML = '<div class="empty-msg">–ü—É—Å—Ç–æ...</div>'; return; }
            inventory.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = `inv-item r-${item.rarity}`;
                div.innerHTML = `
                    <img src="${item.img}" class="item-image">
                    <div style="font-size:12px; margin:5px 0;">${item.name}</div>
                    <button class="inv-sell-one" onclick="sellFromInventory(${index})">–ü—Ä–æ–¥–∞—Ç—å: ${item.price}$</button>
                `;
                grid.appendChild(div);
            });
        }

        function showWinModal(item) {
            if (vkBridge.isWebView()) vkBridge.send("VKWebAppTapticNotificationOccurred", {"type": "success"});
            
            // –°—Ç–∞–≤–∏–º –∫–∞—Ä—Ç–∏–Ω–∫—É –≤ –æ–∫–Ω–æ –≤—ã–∏–≥—Ä—ã—à–∞
            document.getElementById('win-img-src').src = item.img;
            
            document.getElementById('win-name').innerText = item.name;
            document.getElementById('win-price-text').innerText = `–¶–µ–Ω–∞: ${item.price} $`;
            document.getElementById('sell-price-btn').innerText = `+ ${item.price} $`;
            
            const ui = document.getElementById('win-card-ui');
            ui.className = `win-card r-${item.rarity}`;
            document.getElementById('win-modal').style.display = 'flex';
        }

        // --- –û–°–¢–ê–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê (–¢–∞ –∂–µ —Å–∞–º–∞—è) ---
        function switchScreen(n){ document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active-screen')); document.getElementById('screen-'+n).classList.add('active-screen'); }
        function showMenu(){ switchScreen('menu'); }
        function showInventory(){ renderInventory(); switchScreen('inventory'); }
        function openGame(id){ currentCaseId=id; const c=cases[id]; document.getElementById('current-case-name').innerText=c.name; document.getElementById('current-case-price').innerText="–¶–µ–Ω–∞: "+c.price+" $"; initStrip(c); switchScreen('game'); }
        function getRandomItemFromCase(c){ const rand=Math.floor(Math.random()*c.pool.length); return c.pool[rand]; }
        function initStrip(c){ const s=document.getElementById('strip'); s.innerHTML=''; s.style.transition='none'; s.style.transform='translateX(0)'; for(let i=0;i<30;i++) s.appendChild(createCard(getRandomItemFromCase(c))); }
        function spin(){ 
            const c=cases[currentCaseId]; 
            if(balance<c.price){ alert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥!"); return; } 
            balance-=c.price; updateBalance(); 
            document.getElementById('spin-btn').disabled=true;
            let winner=getRandomItemFromCase(c);
            if(c.id===2 && Math.random()>0.85) winner=itemsDB.god[Math.floor(Math.random()*2)];
            currentWonItem=winner;
            const s=document.getElementById('strip'); s.innerHTML=''; s.style.transition='none'; s.style.transform='translateX(0)';
            for(let i=0;i<40;i++) s.appendChild(createCard(getRandomItemFromCase(c)));
            s.appendChild(createCard(winner));
            for(let i=0;i<10;i++) s.appendChild(createCard(getRandomItemFromCase(c)));
            setTimeout(()=>{
                const os=(Math.random()*60)-30; 
                const pos=(40*110)-(s.parentElement.offsetWidth/2)+(110/2)+os;
                s.style.transition="transform 4s cubic-bezier(0.15,0,0.2,1)";
                s.style.transform=`translateX(-${pos}px)`;
                setTimeout(()=>showWinModal(winner),4000);
            },50);
        }
        function actionSell(){ balance+=currentWonItem.price; closeModal(); }
        function actionKeep(){ inventory.push(currentWonItem); closeModal(); }
        function closeModal(){ document.getElementById('win-modal').style.display='none'; document.getElementById('spin-btn').disabled=false; updateBalance(); initStrip(cases[currentCaseId]); }
        function sellFromInventory(i){ balance+=inventory[i].price; inventory.splice(i,1); updateBalance(); renderInventory(); }
        function sellAll(){ if(!inventory.length)return; if(!confirm("–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë?"))return; let t=0; inventory.forEach(i=>t+=i.price); balance+=t; inventory=[]; updateBalance(); renderInventory(); }

        renderCases(); updateBalance();
    </script>
</body>
                    </html>
